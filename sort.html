<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>表格排序</title>
	<link href="css/home.css" rel="stylesheet" type="text/css" />
	<link href="css/bUI.css" rel="stylesheet" type="text/css" />
	<link href="assets/js/google-code-prettify/prettify.css" rel="stylesheet" type="text/css" />
</head>
<body onload="prettyPrint()">
<br />
<div style="width: 800px; margin: 0 auto; ">
<table class="table">
    <thead>
    <tr>
        <th><a href="javascript:" id="dictsort">主题名称 <b class="caret"></b></a></th>
        <th><a href="javascript:" class="numsort">销量 <b class="caret"></b></a></th>
    </tr>
    </thead>
    <tbody id="paper-wrap">
        <tr>
          <td>白色</td>
          <td>14</td>
        </tr>
    </tbody>
</table>
<div id="Pagination" class="pagination"></div>
</div>

<script src="script/ext/sea-jquery.js" data-main="./script/home"></script>
<script src="assets/js/google-code-prettify/prettify.js" data-main="./script/home"></script>
<script src="script/ui/jquery.pagination.js"></script>
<script type="text/javascript">
	$(function(){
	    getPageNum(0);
	});
	var dataArr = []
	, dataArrClone = []
	, itemsPerPage = 5;

	function getPageNum() {
	    $.ajax({
	        url: 'http://localhost/opensource/babyzone-git/api-arr.php',
	        type: 'GET',
	        dataType: 'json',
	        success: function(data) {
	        	dataArr = data.comment;
	        	dataArrClone = dataArr.slice(0);
	            $('#Pagination').pagination(data.pageNum, {
	                current_page: 0,
	                items_per_page: itemsPerPage,
	                callback: pageselectCallback
	            });
	            sortByName();
	            sortByNum();
	        }
	    });
	}

	function sortByNum() {
		$('.numsort').toggle(
			function() {
	    		dataArr.sort(function(a, b) {
	    			return a.order - b.order;
	    		});
	    		pageselectCallback(0);
	    		$(this).addClass('open-dropdown-toggle');
    		},
    		function() {
    			dataArr.sort(function(a, b) {
	    			return b.order - a.order;
	    		});
	    		console.log(dataArr);
	    		pageselectCallback(0);
	    		$(this).removeClass('open-dropdown-toggle');
    		}
    	);
	}

	function sortByName() {
		$('#dictsort').toggle(
			function() {
	    		dataArr.sort(function(a, b) {
	    			return a.name > b.name? -1 : 1;
	    		});
	    		pageselectCallback(0);
	    		$(this).addClass('open-dropdown-toggle');
    		},
    		function() {
    			dataArr = dataArrClone.slice(0);
	    		pageselectCallback(0);
	    		$(this).removeClass('open-dropdown-toggle');
    		}
    	);
	}

	function pageselectCallback(pageIndex){
		$('#paper-wrap').empty();
		var startIndex = pageIndex * itemsPerPage
		, endIndex = startIndex + itemsPerPage;
		endIndex = endIndex > dataArr.length? dataArr.length : endIndex;
		for(startIndex; startIndex < endIndex; startIndex++) {
			var elem = dataArr[startIndex];
			$('#paper-wrap').append(creatHtml(elem.name, elem.order));
		}
	}

	function creatHtml(themeName, themeOrder) {
		var html = [];
		html.push('<tr><td>');
		html.push(themeName);
		html.push('</td><td>');
		html.push(themeOrder);
		html.push('</td></tr>');
		return html.join('');
	}
	</script>
</body>
</html>
